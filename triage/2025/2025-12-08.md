# 2025-12-08 Triage Log

Overall result is negative this week, but both main regressions are on track to be addressed. No outstanding changes otherwise.

Triage done by **@panstromek**.
Revision range: [eca9d93f..55495234](https://perf.rust-lang.org/?start=eca9d93f9057f9a48ff691bd65e7daf2f94c1b67&end=554952348a7dd13851f25789f6bb1061f45c4b60&absolute=false&stat=instructions%3Au)

**Summary**:

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.4%  | [0.1%, 4.3%]   | 111   |
| Regressions ❌ <br /> (secondary)  | 0.4%  | [0.1%, 2.2%]   | 97    |
| Improvements ✅ <br /> (primary)   | -1.0% | [-1.3%, -0.7%] | 2     |
| Improvements ✅ <br /> (secondary) | -0.2% | [-0.3%, -0.0%] | 9     |
| All ❌✅ (primary)                 | 0.4%  | [-1.3%, 4.3%]  | 113   |


3 Regressions, 2 Improvements, 3 Mixed; 3 of them in rollups
30 artifact comparisons made in total

#### Regressions

Rollup of 12 pull requests [#149631](https://github.com/rust-lang/rust/pull/149631) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=556beb9ec72360512d0294eb0855c92fb2c20c88&end=b1b08cdef5ed3bca71c0d6638fccadc90d2e0ea3&stat=instructions:u)

| (instructions:u)                   | mean | range         | count |
|:----------------------------------:|:----:|:-------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -    | -             | 0     |
| Regressions ❌ <br /> (secondary)  | 7.4% | [0.1%, 25.0%] | 10    |
| Improvements ✅ <br /> (primary)   | -    | -             | 0     |
| Improvements ✅ <br /> (secondary) | -    | -             | 0     |
| All ❌✅ (primary)                 | -    | -             | 0     |

Caused by https://github.com/rust-lang/rust/pull/149147, reverted in https://github.com/rust-lang/rust/pull/149657.

Add `#[inline]` to `Layout::is_size_align_valid` [#149690](https://github.com/rust-lang/rust/pull/149690) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=aa301763000fd65db235b2d6e4c04da99abf8cd8&end=1d6c526bb010900bc1fd4c45c4ef0307b5150583&stat=instructions:u)

| (instructions:u)                   | mean | range        | count |
|:----------------------------------:|:----:|:------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 1.2% | [0.1%, 4.3%] | 4     |
| Regressions ❌ <br /> (secondary)  | 1.0% | [0.2%, 2.2%] | 8     |
| Improvements ✅ <br /> (primary)   | -    | -            | 0     |
| Improvements ✅ <br /> (secondary) | -    | -            | 0     |
| All ❌✅ (primary)                 | 1.2% | [0.1%, 4.3%] | 4     |

Little regression matches pre-merge run, justified by https://github.com/rust-lang/rust/pull/149690#issuecomment-3620152210

early return on duplicate span lowerings [#149060](https://github.com/rust-lang/rust/pull/149060) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=1d6c526bb010900bc1fd4c45c4ef0307b5150583&end=fa1f706fbd0fd1c02763ecb28915bf23c860cb32&stat=instructions:u)

| (instructions:u)                   | mean | range        | count |
|:----------------------------------:|:----:|:------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.3% | [0.1%, 0.8%] | 70    |
| Regressions ❌ <br /> (secondary)  | 0.4% | [0.0%, 0.8%] | 73    |
| Improvements ✅ <br /> (primary)   | -    | -            | 0     |
| Improvements ✅ <br /> (secondary) | -    | -            | 0     |
| All ❌✅ (primary)                 | 0.3% | [0.1%, 0.8%] | 70    |

Regression is unexpected, results don't match pre-merge results. Reverted in https://github.com/rust-lang/rust/pull/149757.

#### Improvements

misc coercion cleanups and handle safety correctly [#148602](https://github.com/rust-lang/rust/pull/148602) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=864339abf952f07098dd82610256338520167d4a&end=97b131c90059e6122f22562ab4d78d50160daeff&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -              | 0     |
| Regressions ❌ <br /> (secondary)  | -     | -              | 0     |
| Improvements ✅ <br /> (primary)   | -     | -              | 0     |
| Improvements ✅ <br /> (secondary) | -0.2% | [-0.5%, -0.1%] | 13    |
| All ❌✅ (primary)                 | -     | -              | 0     |


Revert "Rollup merge of #149147 - chenyukang:yukang-fix-unused_assignments-macro-gen-147648, r=JonathanBrouwer" [#149657](https://github.com/rust-lang/rust/pull/149657) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=d427ddfe90367eaa6d2ed7bb8a16559f0230f47a&end=1c5a0cfc13559b863b47b64b51429360fe55ef73&stat=instructions:u)

| (instructions:u)                   | mean  | range           | count |
|:----------------------------------:|:-----:|:---------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -               | 0     |
| Regressions ❌ <br /> (secondary)  | -     | -               | 0     |
| Improvements ✅ <br /> (primary)   | -     | -               | 0     |
| Improvements ✅ <br /> (secondary) | -7.0% | [-20.0%, -0.6%] | 9     |
| All ❌✅ (primary)                 | -     | -               | 0     |


#### Mixed

Rollup of 5 pull requests [#149560](https://github.com/rust-lang/rust/pull/149560) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=646a3f8c15baefb98dc6e0c1c1ba3356db702d2a&end=a4cfac7093a1c1c7fbdb6bc75d6b6dc4d385fc69&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.1%  | [0.1%, 0.1%]   | 1     |
| Regressions ❌ <br /> (secondary)  | -     | -              | 0     |
| Improvements ✅ <br /> (primary)   | -0.4% | [-0.6%, -0.1%] | 2     |
| Improvements ✅ <br /> (secondary) | -     | -              | 0     |
| All ❌✅ (primary)                 | -0.2% | [-0.6%, 0.1%]  | 3     |

I supect the doc regression is mostly noise. Either way, I don't think it's worth more investigation, it's just a doc and it's small.

Rollup of 9 pull requests [#149646](https://github.com/rust-lang/rust/pull/149646) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=b33119ffdd483969934b10a886dc06dd29a473f9&end=3e2dbcdd3a4fc1b5aabfcd0c401c093734e72df2&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.2%  | [0.1%, 0.3%]   | 30    |
| Regressions ❌ <br /> (secondary)  | 0.2%  | [0.1%, 0.4%]   | 7     |
| Improvements ✅ <br /> (primary)   | -0.3% | [-0.4%, -0.2%] | 2     |
| Improvements ✅ <br /> (secondary) | -0.1% | [-0.1%, -0.1%] | 6     |
| All ❌✅ (primary)                 | 0.2%  | [-0.4%, 0.3%]  | 32    |

Based on the results above, the regression seems to be caused by https://github.com/rust-lang/rust/pull/149524. After looking through other PRs, I don't think there's any other candidate. I left a comment on the PR. Author will investigate.

TypeRelating emit WellFormed, not generalize [#148823](https://github.com/rust-lang/rust/pull/148823) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=36b2369c91d32c2659887ed6fe3d570640f44fd2&end=b4f1098e10e71139bbdc08df5ea8183e68fc0955&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -              | 0     |
| Regressions ❌ <br /> (secondary)  | 0.2%  | [0.0%, 0.5%]   | 14    |
| Improvements ✅ <br /> (primary)   | -1.3% | [-1.3%, -1.3%] | 1     |
| Improvements ✅ <br /> (secondary) | -0.2% | [-0.3%, -0.1%] | 8     |
| All ❌✅ (primary)                 | -1.3% | [-1.3%, -1.3%] | 1     |

post-merge results look worse on secondary benchmarks, compared to pre-merge run. The final result still is positive, but only because of 1 primary bechmark. I looked through the secondary regressions and most of them returned back to previous state in next PR, so this is probably noise.
