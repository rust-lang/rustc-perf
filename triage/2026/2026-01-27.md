# 2026-01-27 Triage Log

This week saw a very nice win from doing overall less work in the compiler (https://github.com/rust-lang/rust/pull/151382). There were a few regressions, but only in artificial stress tests,
we are keeping an eye on them.

Triage done by **@kobzol**.
Revision range: [3d087e60..ebf13cca](https://perf.rust-lang.org/?start=3d087e6044bddc65723bf42c76fe4cc33a0076b0&end=ebf13cca58b551b83133d4895e123f7d1e795111&absolute=false&stat=instructions%3Au)

**Summary**:

| (instructions:u)                   | mean  | range           | count |
|:----------------------------------:|:-----:|:---------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.6%  | [0.2%, 1.8%]    | 9     |
| Regressions ❌ <br /> (secondary)  | 3.1%  | [0.1%, 19.9%]   | 47    |
| Improvements ✅ <br /> (primary)   | -1.0% | [-3.1%, -0.2%]  | 195   |
| Improvements ✅ <br /> (secondary) | -1.4% | [-10.1%, -0.1%] | 157   |
| All ❌✅ (primary)                 | -1.0% | [-3.1%, 1.8%]   | 204   |


2 Regressions, 2 Improvements, 6 Mixed; 6 of them in rollups
42 artifact comparisons made in total

#### Regressions

Rollup of 8 pull requests [#151395](https://github.com/rust-lang/rust/pull/151395) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=79818181387879de7a521366d9bea23624728462&end=fffc4fcf96b30bc838551de5104d74f82400b35b&stat=instructions:u)

| (instructions:u)                   | mean | range        | count |
|:----------------------------------:|:----:|:------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.4% | [0.2%, 0.9%] | 18    |
| Regressions ❌ <br /> (secondary)  | 0.7% | [0.2%, 1.1%] | 24    |
| Improvements ✅ <br /> (primary)   | -    | -            | 0     |
| Improvements ✅ <br /> (secondary) | -    | -            | 0     |
| All ❌✅ (primary)                 | 0.4% | [0.2%, 0.9%] | 18    |

* The doc regressions were caused by [#151091](https://github.com/rust-lang/rust/pull/151091).
* This adds new functionality to rustdoc.
* Already marked as triaged.

Rollup of 12 pull requests [#151716](https://github.com/rust-lang/rust/pull/151716) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=b3cda168c8afd5c4240a9477f6a7f54e70e2589a&end=ebf13cca58b551b83133d4895e123f7d1e795111&stat=instructions:u)

| (instructions:u)                   | mean | range        | count |
|:----------------------------------:|:----:|:------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -    | -            | 0     |
| Regressions ❌ <br /> (secondary)  | 4.0% | [0.0%, 5.2%] | 10    |
| Improvements ✅ <br /> (primary)   | -    | -            | 0     |
| Improvements ✅ <br /> (secondary) | -    | -            | 0     |
| All ❌✅ (primary)                 | -    | -            | 0     |

* Considerable regression on a single stress test caused by [#151529](https://github.com/rust-lang/rust/pull/151529).
* Continuing discussion on the PR.
* Marked as triaged.

#### Improvements

Only run finalizers of accepted attributes [#151382](https://github.com/rust-lang/rust/pull/151382) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=af6695c1142706c7a0718431f49057fa52e4c33f&end=d276646872981067251b0fe70131561f4a4142d8&stat=instructions:u)

| (instructions:u)                   | mean  | range           | count |
|:----------------------------------:|:-----:|:---------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -               | 0     |
| Regressions ❌ <br /> (secondary)  | 0.0%  | [0.0%, 0.0%]    | 1     |
| Improvements ✅ <br /> (primary)   | -1.0% | [-3.2%, -0.2%]  | 182   |
| Improvements ✅ <br /> (secondary) | -1.7% | [-10.0%, -0.1%] | 110   |
| All ❌✅ (primary)                 | -1.0% | [-3.2%, -0.2%]  | 182   |


Rollup of 4 pull requests [#151443](https://github.com/rust-lang/rust/pull/151443) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=88ad3d44ca811d988cb4df35f7ab8ac9d4fca451&end=838db2538201a845a3694c99d9114a1acebd6e28&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -              | 0     |
| Regressions ❌ <br /> (secondary)  | 0.1%  | [0.0%, 0.2%]   | 2     |
| Improvements ✅ <br /> (primary)   | -0.3% | [-0.3%, -0.2%] | 11    |
| Improvements ✅ <br /> (secondary) | -0.5% | [-1.0%, -0.2%] | 22    |
| All ❌✅ (primary)                 | -0.3% | [-0.3%, -0.2%] | 11    |


#### Mixed

Rollup of 15 pull requests [#151381](https://github.com/rust-lang/rust/pull/151381) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=d940e56841ddcc05671ead99290e35ff2e98369f&end=63f4513795b198d034f5d19962659ea488163755&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -              | 0     |
| Regressions ❌ <br /> (secondary)  | 4.6%  | [0.1%, 20.1%]  | 20    |
| Improvements ✅ <br /> (primary)   | -0.2% | [-0.2%, -0.2%] | 1     |
| Improvements ✅ <br /> (secondary) | -0.1% | [-0.1%, -0.1%] | 1     |
| All ❌✅ (primary)                 | -0.2% | [-0.2%, -0.2%] | 1     |

* A large regression on stress tests was caused by [#148623](https://github.com/rust-lang/rust/pull/148623).
* Continuing discussion on the PR.
* Marked as triaged.

compiler: upgrade to hashbrown 0.16.1 [#151076](https://github.com/rust-lang/rust/pull/151076) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=058a763dd295a4ea6a8d0c94e326d852e32f52ea&end=79818181387879de7a521366d9bea23624728462&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.2%  | [0.2%, 0.2%]   | 3     |
| Regressions ❌ <br /> (secondary)  | 0.6%  | [0.1%, 1.2%]   | 8     |
| Improvements ✅ <br /> (primary)   | -0.8% | [-0.8%, -0.7%] | 2     |
| Improvements ✅ <br /> (secondary) | -0.3% | [-1.4%, -0.1%] | 12    |
| All ❌✅ (primary)                 | -0.2% | [-0.8%, 0.2%]  | 5     |

* Dependency update, performance-wise overall a wash.
* Marked as triaged.

Use `repeat_packed` when calculating layouts in `RawVec` [#151389](https://github.com/rust-lang/rust/pull/151389) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=165591238e723f2e4a1adecb0b4bacebb805bb6f&end=9283d592deb2887311b9fa95027fd78c2172e554&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 1.2%  | [0.7%, 1.8%]   | 2     |
| Regressions ❌ <br /> (secondary)  | 0.4%  | [0.2%, 1.6%]   | 9     |
| Improvements ✅ <br /> (primary)   | -0.2% | [-0.8%, -0.2%] | 35    |
| Improvements ✅ <br /> (secondary) | -0.4% | [-1.8%, -0.1%] | 43    |
| All ❌✅ (primary)                 | -0.2% | [-0.8%, 1.8%]  | 37    |

* More improvements than regressions.
* Already marked as triaged.

Rollup of 10 pull requests [#151634](https://github.com/rust-lang/rust/pull/151634) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=75963ce795666bc1f961e5d60060809809f6bc68&end=4d38622e8bec00a9001264c4e9f4723fceca23cb&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.7%  | [0.7%, 0.7%]   | 1     |
| Regressions ❌ <br /> (secondary)  | 1.0%  | [0.3%, 3.0%]   | 5     |
| Improvements ✅ <br /> (primary)   | -     | -              | 0     |
| Improvements ✅ <br /> (secondary) | -0.6% | [-0.9%, -0.2%] | 7     |
| All ❌✅ (primary)                 | 0.7%  | [0.7%, 0.7%]   | 1     |

* While the regression on the incremental case of a single stress test looks real, there is only a single tiny regression on real world benchmarks, and overall the results are a wash. I don't think it's worth it investigating further.
* Marked as triaged.

optimize `vec.extend(slice.to_vec())`, take 2 [#151337](https://github.com/rust-lang/rust/pull/151337) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=38c71295e8cdc6f04511fd7a12b28f000b620994&end=873d4682c7d285540b8f28bfe637006cef8918a6&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | 0.6%  | [0.3%, 1.0%]   | 6     |
| Regressions ❌ <br /> (secondary)  | 0.3%  | [0.0%, 0.7%]   | 4     |
| Improvements ✅ <br /> (primary)   | -0.6% | [-0.7%, -0.5%] | 2     |
| Improvements ✅ <br /> (secondary) | -0.5% | [-4.2%, -0.0%] | 12    |
| All ❌✅ (primary)                 | 0.3%  | [-0.7%, 1.0%]  | 8     |

* The results are a wash overall.
* Marked as triaged.

Rollup of 5 pull requests [#151727](https://github.com/rust-lang/rust/pull/151727) [(Comparison Link)](https://perf.rust-lang.org/compare.html?start=ebf13cca58b551b83133d4895e123f7d1e795111&end=78df2f92de1da3601d967dc8beb9f9cea267e45f&stat=instructions:u)

| (instructions:u)                   | mean  | range          | count |
|:----------------------------------:|:-----:|:--------------:|:-----:|
| Regressions ❌ <br /> (primary)    | -     | -              | 0     |
| Regressions ❌ <br /> (secondary)  | 0.1%  | [0.0%, 0.1%]   | 4     |
| Improvements ✅ <br /> (primary)   | -0.3% | [-0.3%, -0.3%] | 1     |
| Improvements ✅ <br /> (secondary) | -0.1% | [-0.1%, -0.0%] | 3     |
| All ❌✅ (primary)                 | -0.3% | [-0.3%, -0.3%] | 1     |

* The regressions are very tiny and only on two secondary benchmarks, I don't think we have to investigate further.
* Marked as triaged.
